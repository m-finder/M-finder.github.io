---
title: php å’Œè®¾è®¡æ¨¡å¼ - è®¾è®¡åŸåˆ™
date: 2021-03-21 14:35:02
categories:
- è®¾è®¡æ¨¡å¼
tags: 
---

è®¾è®¡æ¨¡å¼æ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨ã€å¤šæ•°äººçŸ¥æ™“ã€ç»è¿‡åˆ†ç±»ç¼–ç›®çš„ã€ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ã€‚ä½¿ç”¨è®¾è®¡æ¨¡å¼æ˜¯ä¸ºäº† `æé«˜ä»£ç å¤ç”¨æ€§` å’Œ `çµæ´»æ€§`ï¼Œè®©ä»£ç æ›´å®¹æ˜“è¢«ä»–äººç†è§£ã€ä¿è¯ä»£ç  `å¯é æ€§`ã€‚

ä¸ºäº†å®ç°ä»£ç çš„ `å¯å¤ç”¨æ€§` å’Œ `çµæ´»æ€§`ã€‚`è®¾è®¡æ¨¡å¼` æå‡ºäº†ä¸€äº›å…³é”®çš„ `é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™`ã€‚


#### å•ä¸€èŒè´£

å…¶æ ¸å¿ƒæ€æƒ³ä¸ºï¼šä¸€ä¸ªç±»ï¼Œæœ€å¥½åªåšä¸€ä»¶äº‹ï¼Œåº”è¯¥ä»…æœ‰ä¸€ä¸ªå¼•èµ·å®ƒå˜åŒ–çš„åŸå› ã€‚

å¯ä»¥ç†è§£ä¸ºï¼Œä¸€ä¸ªç±»ï¼Œåº”è¯¥æ˜¯ä¸€ç»„ `ç›¸å…³æ€§å¾ˆé«˜` çš„æ–¹æ³•åŠæ•°æ®çš„å°è£…ã€‚

å½“ä¸€ä¸ªç±»æ‰¿æ‹…çš„èŒè´£è¿‡å¤šæ—¶ï¼Œå°±ç›¸å½“äºæŠŠè¿™äº›èŒè´£è€¦åˆåœ¨äº†ä¸€èµ·ï¼Œå½“å…¶ä¸­ä¸€ä¸ªèŒè´£å‘ç”Ÿå˜åŠ¨ï¼Œå¯èƒ½ä¼šå¯¹å…¶ä»–èŒè´£é€ æˆå½±å“ã€‚

ç±»çš„èŒè´£åŒ…æ‹¬ä¸¤ä¸ªæ–¹é¢ï¼Œæ•°æ®èŒè´£å’Œè¡Œä¸ºèŒè´£ï¼Œæ•°æ®èŒè´£é€šè¿‡ç±»çš„å±æ€§å®ç°ï¼Œè¡Œä¸ºèŒè´£é€šè¿‡å…¶æ–¹æ³•å®ç°ã€‚

å•ä¸€èŒè´£æ˜¯å®ç°é«˜å†…èšã€ä½è€¦åˆçš„æŒ‡å¯¼æ–¹é’ˆã€‚å®ƒæ˜¯æœ€ç®€å•ä½†åˆæœ€éš¾å®ç°çš„åŸåˆ™ï¼Œéœ€è¦å¼€å‘äººå‘˜å‘ç°ç±»çš„çš„ä¸åŒèŒè´£å¹¶å°†å…¶åˆ†ç¦»ã€‚

ä¸¾ä¸ªğŸŒ°ï¼šç™»é™†æ¨¡å—æ˜¾ç¤ºç™»å½•é¡µé¢ï¼Œæ ¡éªŒç™»å½•å‚æ•°ï¼Œè¿æ¥æ•°æ®åº“ï¼ŒæŸ¥æ‰¾ç”¨æˆ·ï¼Œè¿”å›ç»“æœã€‚

åŠŸèƒ½å¤ªè¿‡è€¦åˆï¼Œæ‹†åˆ†æˆå¤šä¸ªæ¨¡å—ã€‚


#### å¼€é—­åŸåˆ™

å¼€é—­åŸåˆ™æ˜¯é¢å‘å¯¹è±¡ä¸­æœ€é‡è¦çš„åŸåˆ™ã€‚

ä¸€ä¸ªè½¯ä»¶åº”å½“å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨è®¾è®¡ä¸€ä¸ªæ¨¡å—çš„æ—¶å€™ï¼Œåº”è¯¥ä½¿è¿™ä¸ªæ¨¡å—å¯ä»¥åœ¨ä¸è¢«ä¿®æ”¹çš„å‰æä¸‹è¿›è¡Œæ‰©å±•ã€‚

ä¸€ä¸ªç±»ä¸€æ—¦å¼€å‘å®Œæˆï¼Œåç»­æ–°å¢çš„åŠŸèƒ½å°±ä¸åº”è¯¥é€šè¿‡ä¿®æ”¹è¿™ä¸ªç±»æ¥å®Œæˆï¼Œè€Œæ˜¯åº”è¯¥é€šè¿‡ç»§æ‰¿å¢åŠ æ–°çš„ç±»ã€‚ä¸ºä»€ä¹ˆè¦å¯¹ä¿®æ”¹å…³é—­å‘¢ï¼Ÿå› ä¸ºä¸€æ—¦ä¿®æ”¹æŸä¸ªç±»ï¼Œå°±å¯èƒ½ç ´åäº†ç³»ç»ŸåŸæœ‰åŠŸèƒ½ï¼Œå°±éœ€è¦é‡æ–°æµ‹è¯•ã€‚

`æŠ½è±¡åŒ–` æ˜¯å¼€é—­åŸåˆ™çš„å…³é”®ã€‚ä»€ä¹ˆæ˜¯æŠ½è±¡åŒ–ï¼Œå°±æ˜¯æŠŠä¸€ä¸ªæˆ–å¤šä¸ªç±»ä¸­çš„å…¬å…±çš„ã€æœ‰å…±æ€§çš„ä¸œè¥¿æŠ½å–å‡ºæ¥ã€‚æŠ½è±¡çš„æœ€å¤§å¥½å¤„åœ¨äºå®ƒæ˜¯æŠ½è±¡çš„ã€ç¨³å®šçš„ï¼Œä¸å®¹æ˜“å‘ç”Ÿæ”¹å˜çš„ã€‚å®ç°å¼€é—­åŸåˆ™çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯ `é¢å‘æ¥å£ç¼–ç¨‹`ï¼Œè€Œä¸æ˜¯å…·ä½“å®ç°ã€‚

å¼€é—­åŸåˆ™å¯ä»¥ç”¨ä¸€ä¸ªæ›´åŠ å…·ä½“çš„åŸåˆ™æ¥æè¿°ï¼š`å¯å˜æ€§å°è£…`ã€‚ä¹Ÿå°±æ˜¯æ‰¾åˆ°ç³»ç»Ÿä¸­çš„å¯å˜å› ç´ å¹¶æŠŠå®ƒå°è£…èµ·æ¥ã€‚

ä¸Šä¸€ç¯‡ä¸­æåˆ°çš„ç¯æ˜¯ä¸ªç»ä½³çš„ğŸŒ°ã€‚

#### é‡Œæ°æ›¿æ¢
æ‰€æœ‰å¼•ç”¨åŸºç±»ï¼ˆçˆ¶ç±»ï¼‰çš„åœ°æ–¹å¿…é¡»èƒ½é€æ˜çš„ä½¿ç”¨å…¶å­ç±»çš„å¯¹è±¡ã€‚

è¿™å¥è¯æ€ä¹ˆç†è§£å‘¢ï¼Ÿé€šä¿—æ¥è®²å°±æ˜¯åœ¨è½¯ä»¶ä¸­å¦‚æœèƒ½å¤Ÿä½¿ç”¨åŸºç±»å¯¹è±¡ï¼Œé‚£ä¹ˆä¸€å®šä¹Ÿå¯ä»¥ä½¿ç”¨å…¶å­ç±»å¯¹è±¡ã€‚æŠŠåŸºç±»éƒ½æ›¿æ¢ä¸ºå®ƒçš„å­ç±»å¯¹è±¡ï¼Œç¨‹åºä¸ä¼šäº§ç”Ÿä»»ä½•é”™è¯¯å’Œå¼‚å¸¸ã€‚åè¿‡æ¥åˆ™ä¸æˆç«‹ã€‚

é‡Œæ°æ›¿æ¢åº”è¯¥æ˜¯å¼€é—­åŸåˆ™çš„ä¸€ä¸ªæ‰©å±•ï¼Œç”±äºä½¿ç”¨åŸºç±»å¯¹è±¡çš„åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨å…¶å­ç±»å¯¹è±¡ï¼Œå› æ­¤åœ¨ç¨‹åºä¸­å°½é‡ä»¥åŸºç±»ç±»å‹æ¥å¯¹å¯¹è±¡è¿›è¡Œå®šä¹‰ï¼Œè€Œåœ¨è¿è¡Œæ—¶å†ç”¨å…¶å­ç±»å¯¹è±¡æ›¿æ¢åŸºç±»å¯¹è±¡ã€‚

å…¶ä¸­æœ‰ä¸€ç‚¹å¾ˆå…³é”®ï¼Œé‡Œæ°æ›¿æ¢åŸåˆ™å¼ºè°ƒå­ç±»å°½é‡ä½¿ç”¨åŸºç±»ä¸­çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯é‡å†™ï¼Œé™¤éå­ç±»æœ‰å…¶ç‰¹æ®Šæ€§ã€‚

ä¸¾ä¸ªğŸŒ°ï¼Œä¾ç„¶æ˜¯ä¸Šä¸€ç¯‡æåˆ°çš„{% post_link https://www.m-finder.com/2021/03/21/design-pattern-object/  ç¯ %}ï¼Œä½†æ˜¯åŠ äº†ä¸€ç‚¹æ”¹åŠ¨ï¼š
```php
class Light
{
    function show()
    {
        echo 'ç¯å…‰éšæœº', PHP_EOL;
    }
}

class BlueLight extends Light
{
    function show()
    {
        echo 'è“è‰²', PHP_EOL;
    }
}

class RedLight extends Light
{
    private bool $power = false;

    public function hasPower(): bool
    {
        return $this->power;
    }

    /**
     * @throws Exception
     */
    function show()
    {
        if(!$this->hasPower()){
            throw new Exception('æ²¡ç”µäº†ï¼Œäº®ä¸èµ·æ¥');
        }
        echo 'çº¢è‰²', PHP_EOL;
    }
}

class User
{
    function openLight(Light $light)
    {
        $light->show();
    }
}

$user = new User();
$light = new Light();
$blueLight = new BlueLight();
$redLight = new RedLight();

$user->openLight($light);
$user->openLight($blueLight);
$user->openLight($redLight);
```

![uml](/images/uml.png)

æ ¹æ®é‡Œæ°æ›¿æ¢åŸåˆ™ï¼Œå­ç±»å¿…é¡»èƒ½å¤Ÿæ›¿ä»£çˆ¶ç±»ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè™½ç„¶å­ç±»é‡å†™äº†çˆ¶ç±»çš„æ–¹æ³•ï¼Œä½†æ˜¯åœ¨èƒ½å¤Ÿä½¿ç”¨çˆ¶ç±»çš„åœºæ™¯é‡Œé¢ï¼Œä¹Ÿä¸€å®šè¦èƒ½å¤Ÿä½¿ç”¨å­ç±»ã€‚å¾ˆæ˜¾ç„¶ï¼ŒBlueLight ç±»ç¬¦åˆåŸåˆ™ï¼ŒRedLight ç±»è™½ç„¶ä¹Ÿå®ç°äº†çˆ¶ç±»æ–¹æ³•ï¼Œä½†æ˜¯æŠ›å‡ºäº†çˆ¶ç±»æ²¡æœ‰çš„å¼‚å¸¸ï¼Œæ‰€ä»¥è¿åäº†é‡Œæ°æ›¿æ¢åŸåˆ™ï¼Œåœ¨ User ç±»ä¸­ï¼Œæˆ‘ä»¬æ— è®ºæ˜¯ä¼ å…¥ Light åŸºç±»å¯¹è±¡ï¼Œè¿˜æ˜¯ BlueLight ç±»å¯¹è±¡ï¼Œéƒ½æ˜¯æ²¡æœ‰ä»»ä½•é”™è¯¯å’Œå¼‚å¸¸çš„ã€‚

ç”±ä»¥ä¸Šå®ä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“å‡ºï¼Œé‡Œæ°æ›¿æ¢åŸåˆ™æœ¬è´¨æ˜¯å¯¹ç»§æ‰¿çš„çº¦æŸã€‚

#### ä¾èµ–å€’ç½®

ä¾èµ–äºæŠ½è±¡å±‚ï¼Œä¸ä¾èµ–äºå…·ä½“ã€‚å³é«˜å±‚æ¬¡çš„æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½å±‚æ¬¡æ¨¡å—ã€‚
æŠ½è±¡ä¸åº”è¯¥ä¾èµ–äºç»†èŠ‚ï¼Œç»†èŠ‚åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚

è¦é¢å‘æ¥å£ç¼–ç¨‹ï¼Œè€Œä¸æ˜¯é¢å‘å®ç°ç¼–ç¨‹ã€‚

ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è®¤ä¸ºè°ƒç”¨è€…æ˜¯é«˜å±‚æ¨¡å—ï¼Œè¢«è°ƒç”¨è€…æ˜¯åº•å±‚æ¨¡å—ã€‚

å®ç°å¼€é—­åŸåˆ™çš„å…³é”®æ˜¯æŠ½è±¡åŒ–ï¼Œå¦‚æœè¯´å®ç°å¼€é—­åŸåˆ™æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ç›®æ ‡ï¼Œé‚£ä¹ˆä¾èµ–å€’ç½®å°±æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¸»è¦æ‰‹æ®µã€‚å¸¸ç”¨çš„æ‰‹æ®µä¸ºåœ¨ä»£ç ä¸­ä½¿ç”¨æŠ½è±¡ç±»ï¼Œå°†å…·ä½“å®ç°æ”¾å…¥å…ƒæ•°æ®ã€‚

å†å¼ºè°ƒä¸€éï¼ŒæŠ½è±¡æ˜¯ç›¸å¯¹ç¨³å®šçš„ï¼Œä¸å®¹æ˜“å‘ç”Ÿæ”¹å˜ã€‚

å†ä¸¾ä¸ªğŸŒ°ï¼š
```php
class Book
{
    public function getContent()
    {
        echo 'long long ago, é¥è¿œçš„ä¸œæ–¹æœ‰ä¸€ä¸ªç‰¹åˆ«è‹±ä¿Šå¸…æ°”çš„å°ä¼™', PHP_EOL;
    }
}

class Mother
{
    public function narrate(Book $book)
    {
        $book->getContent();
    }
}

class Paper
{
    public function getContent()
    {
        echo 'ä¸Šå‘¨äº”ï¼Œä¸­å›½é¦–æ¬¡å®ç°ç»æµåè¶…ç¾å›½ç§°ä¸ºä¸–ç•Œç¬¬ä¸€ç»æµä½“', PHP_EOL;
    }
}
$mother = new Mother();
$mother->narrate(new Book());
```
åœ¨ä¸Šè¾¹çš„ä¾‹å­ä¸­ï¼Œéº»éº»çœ‹ä¹¦è®²æ•…äº‹ï¼Œå¦‚æœæœ‰ä¸€å¤©ï¼Œä¹¦çœ‹çƒ¦äº†ï¼Œæƒ³çœ‹ä¸ªæŠ¥çº¸ï¼Œä½†æ˜¯éº»éº»åšä¸åˆ°ï¼Œå› ä¸ºè¦è¯»æŠ¥çº¸é¦–å…ˆè¦æŠŠéº»éº»æ”¹æ‰ã€‚è¿™å°±æœ‰ç‚¹è’è°¬ã€‚æ˜¾ç¤ºä¸æ˜¯ä¸€ä¸ªå¥½çš„è®¾è®¡ï¼ŒåŸå› å°±æ˜¯éº»éº»å’Œä¹¦ä¹‹é—´çš„è€¦åˆç¨‹åº¦å¤ªé«˜äº†ï¼Œå¿…é¡»é™ä½ä»–ä»¬ä¹‹é—´çš„è€¦åˆåº¦ã€‚

æˆ‘ä»¬æ¥åšä¸‹è°ƒæ•´ï¼š
```php
interface Reader
{
    public function getContent();
}

class Book implements Reader
{
    public function getContent()
    {
        echo 'long long ago, é¥è¿œçš„ä¸œæ–¹æœ‰ä¸€ä¸ªç‰¹åˆ«è‹±ä¿Šå¸…æ°”çš„å°ä¼™', PHP_EOL;
    }
}

class Paper implements Reader
{
    public function getContent()
    {
        echo 'ä¸Šå‘¨äº”ï¼Œä¸­å›½é¦–æ¬¡å®ç°ç»æµåè¶…ç¾å›½ç§°ä¸ºä¸–ç•Œç¬¬ä¸€ç»æµä½“', PHP_EOL;
    }
}

class Mother
{
    public function narrate(Reader $reader)
    {
        $reader->getContent();
    }
}

$mother = new Mother();
$mother->narrate(new Book());
$mother->narrate(new Paper());
```
é¦–å…ˆï¼Œæˆ‘ä»¬æŠ½å–å‡ºä¸€ä¸ªæ¥å£ç±» `Reader`ï¼Œç„¶å Book å’Œ Paper åˆ†åˆ«å»å®ç°å®ƒã€‚ç„¶åå°† Mother è°ƒæ•´ä¸ºä¾èµ–äºæ¥å£ã€‚
ç°åœ¨ï¼Œæ— è®ºæ˜¯æƒ³çœ‹ä¹¦è¿˜æ˜¯æƒ³çœ‹æŠ¥çº¸ï¼Œåˆæˆ–è€…æƒ³çœ‹è¿ç¯ç”»ï¼Œæˆ‘ä»¬åªè¦å»å®ç° Reader å³å¯ï¼Œå†ä¹Ÿä¸ç”¨æ”¹åŠ¨ Mother äº†ã€‚

ä¸Šè¾¹é‡Œæ°æ›¿æ¢ä¸­ç¯çš„ä¾‹å­å…¶å®å·²ç»ç¬¦åˆä¾èµ–å€’ç½®åŸåˆ™ï¼Œä½†æ˜¯çœ‹åˆ°è¿™ä¸ªä¾‹å­æ›´ç”ŸåŠ¨ï¼Œæ›´å®¹æ˜“ç†è§£ï¼Œæ‰€ä»¥å°±èµ˜è¿°äº†ä¸€ä¸‹ã€‚

> ä¼ é€’ä¾èµ–å…³ç³»çš„æ–¹å¼æœ‰ä¸‰ç§ï¼Œä¸Šè¾¹çš„ä¾‹å­ä¸­ä½¿ç”¨çš„æ¥å£ä¼ é€’ï¼Œè¿˜æœ‰æ„é€ å‡½æ•°ä¼ é€’å’Œ setter ä¼ é€’ã€‚


#### æ¥å£éš”ç¦»

å®¢æˆ·ç«¯ä¸åº”è¯¥ä¾èµ–å®ƒä¸éœ€è¦çš„æ¥å£ã€‚

ä½¿ç”¨å¤šä¸ªä¸“é—¨çš„æ¥å£ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå¤§çš„å•ä¸€çš„æ¥å£ã€‚

çœ‹ä¸Šå»ä¼¼ä¹å’Œå•ä¸€èŒè´£å¾ˆåƒï¼Œä½†æ˜¯ä¸æ˜¯ï¼Œå•ä¸€èŒè´£é’ˆå¯¹çš„æ˜¯ç±»çš„èŒè´£ï¼Œæ¥å£éš”ç¦»é’ˆå¯¹çš„åˆ™æ˜¯æ¥å£ã€‚

ä¸¾ä¸ªğŸŒ°ï¼š
```php
interface WorkerInterface
{
    public function work();

    public function sleep();
}

class HumanWorker implements WorkerInterface
{

    public function work()
    {
        echo 'I like working', PHP_EOL;
    }

    public function sleep()
    {
        echo 'I like sleeping', PHP_EOL;
    }
}

class RobotWorker implements WorkerInterface
{
    public function work()
    {
        echo 'I like working', PHP_EOL;
    }

    public function sleep()
    {
        echo 'robot never sleep', PHP_EOL;
    }
}
```
ä¸Šè¾¹çš„ä¾‹å­ä¸­ï¼Œæœ‰ä¸ªå¾ˆæ˜æ˜¾çš„ç¼ºç‚¹ï¼Œæœºå™¨äººä¸éœ€è¦ç¡è§‰ï¼Œä½†æ˜¯å®ƒå´å¿…é¡»å®ç°ç¡è§‰çš„æ–¹æ³•ï¼Œè¿™æ˜¾ç„¶è¿åäº†æ¥å£éš”ç¦»ã€‚

é‚£ä¹ˆï¼Œæˆ‘ä»¬å†è°ƒæ•´ä¸€ä¸‹ï¼š
```php
interface WorkInterface
{
    public function work();

}

interface SleepInterface
{
    public function sleep();
}

class HumanWorker implements WorkInterface, SleepInterface
{

    public function work()
    {
        echo 'I like working', PHP_EOL;
    }

    public function sleep()
    {
        echo 'I like sleeping', PHP_EOL;
    }
}

class RobotWorker implements WorkInterface
{
    public function work()
    {
        echo 'I like working', PHP_EOL;
    }
}
```
è°ƒæ•´åï¼Œæ¥å£ä¸€åˆ†ä¸ºäºŒï¼Œå®é™…ä½¿ç”¨æ—¶å„å–æ‰€éœ€ï¼Œä¸å†è¢«è¿«å®ç°è‡ªå·±ä¸éœ€è¦çš„æ¥å£ã€‚

#### åˆæˆå¤ç”¨

#### è¿ªç±³ç‰¹æ³•åˆ™




